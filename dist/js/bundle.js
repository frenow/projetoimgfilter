!function(t){function e(r){if(i[r])return i[r].exports;var n=i[r]={i:r,l:!1,exports:{}};return t[r].call(n.exports,n,n.exports,e),n.l=!0,n.exports}var i={};e.m=t,e.c=i,e.d=function(t,i,r){e.o(t,i)||Object.defineProperty(t,i,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=0)}([function(t,e,i){"use strict";function r(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"sem_nome.jpg",i=this;this.fileArea=t,this.fileTitle=e,this.init=function(){i.fileArea.addEventListener("dragleave",i.dragHover,!1),i.fileArea.addEventListener("dragover",i.dragHover,!1),i.fileArea.addEventListener("drop",i.drop,!1)},this.dragHover=function(t){t.stopPropagation(),t.preventDefault(),i.fileArea.className="dragover"==t.type?"hover":""},this.drop=function(t){i.dragHover(t),i.file=t.dataTransfer.files[0],i.fileTitle.innerHTML=i.file.name,i.read(i.file)},this.read=function(t){if(t.type.match("image.*")){var e=new FileReader;e.onload=function(t){i.fileArea.innerHTML="",i.fileArea.setAttribute("style","padding: 0px !important;\n\t\t                                       border-radius: 20px;\n\t\t\t\t\t\t\t\t\t\t\t   border: 1px solid #ddd;");var e=document.createElement("img");e.setAttribute("id","img_ori"),e.setAttribute("src",t.target.result),i.fileArea.appendChild(e)},e.readAsDataURL(t)}},this.sendFile=function(t){var e=new FormData;e.append("file",t);var i=new XMLHttpRequest;i.open("POST","",!0),i.send(e),i.onreadystatechange=function(){i.readyState}}}i(1),i(2),i(3);i(8);new r(document.getElementById("image-area"),document.getElementById("title")).init()},function(t,e,i){t.exports=i.p+"img/favicon.ico"},function(t,e,i){t.exports=i.p+"img/icon.png"},function(t,e,i){var r=i(4);"string"==typeof r&&(r=[[t.i,r,""]]);var n={};n.transform=void 0;i(6)(r,n);r.locals&&(t.exports=r.locals)},function(t,e,i){e=t.exports=i(5)(void 0),e.push([t.i,'/* ==========================================================================\r\n   CSS UPLOAD DRAG AND DROP\r\n   ========================================================================== */\nhtml {\n  font-size: 1em;\n  line-height: 1.4;\n  background-color: #e8f0f0;\n  color: #222; }\n  html body {\n    width: 90%;\n    padding: 0;\n    margin: 0 auto !important; }\n  html main #example-content {\n    text-align: center;\n    float: left; }\n  html main #frame {\n    background-color: #000;\n    color: #fff;\n    margin: 50px;\n    width: 400px;\n    height: 450px;\n    padding: 50px; }\n  html main #image-area {\n    padding-top: 50%;\n    padding-bottom: 50%;\n    margin-bottom: 15px;\n    width: 100%;\n    border: 1px dotted #fff;\n    overflow: hidden; }\n  html main #divButtonFormat {\n    /*background-color: #0b6cc7;*/\n    margin: 0px;\n    width: 260px;\n    height: 100%;\n    padding: 50px;\n    float: left; }\n  html main .buttonFormat {\n    border-radius: 8px;\n    background-color: #0a0b14 !important;\n    font-family: "Segoe UI";\n    text-shadow: 0 1px 0 #666;\n    box-shadow: inset 0 1px 1px #fff, 0 2px 3px #666;\n    padding: 4px 11px;\n    margin: 2px;\n    width: 250px;\n    height: 40px;\n    border: 1px solid #0a0b14;\n    color: #fff;\n    cursor: pointer;\n    position: relative; }\n    html main .buttonFormat:hover {\n      box-shadow: inset 0 4px 5px #fff, 0 2px 3px #666;\n      font-weight: bold; }\n    html main .buttonFormat:active {\n      box-shadow: inset 0 4px 5px #fff, 0 1px 3px #666 !important;\n      top: 2px; }\n  html main h1 {\n    text-align: center; }\n',""])},function(t,e){function i(t,e){var i=t[1]||"",n=t[3];if(!n)return i;if(e&&"function"==typeof btoa){var s=r(n);return[i].concat(n.sources.map(function(t){return"/*# sourceURL="+n.sourceRoot+t+" */"})).concat([s]).join("\n")}return[i].join("\n")}function r(t){return"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(t))))+" */"}t.exports=function(t){var e=[];return e.toString=function(){return this.map(function(e){var r=i(e,t);return e[2]?"@media "+e[2]+"{"+r+"}":r}).join("")},e.i=function(t,i){"string"==typeof t&&(t=[[null,t,""]]);for(var r={},n=0;n<this.length;n++){var s=this[n][0];"number"==typeof s&&(r[s]=!0)}for(n=0;n<t.length;n++){var o=t[n];"number"==typeof o[0]&&r[o[0]]||(i&&!o[2]?o[2]=i:i&&(o[2]="("+o[2]+") and ("+i+")"),e.push(o))}},e}},function(t,e,i){function r(t,e){for(var i=0;i<t.length;i++){var r=t[i],n=p[r.id];if(n){n.refs++;for(var s=0;s<n.parts.length;s++)n.parts[s](r.parts[s]);for(;s<r.parts.length;s++)n.parts.push(u(r.parts[s],e))}else{for(var o=[],s=0;s<r.parts.length;s++)o.push(u(r.parts[s],e));p[r.id]={id:r.id,refs:1,parts:o}}}}function n(t,e){for(var i=[],r={},n=0;n<t.length;n++){var s=t[n],o=e.base?s[0]+e.base:s[0],a=s[1],h=s[2],c=s[3],u={css:a,media:h,sourceMap:c};r[o]?r[o].parts.push(u):i.push(r[o]={id:o,parts:[u]})}return i}function s(t,e){var i=m(t.insertInto);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var r=y[y.length-1];if("top"===t.insertAt)r?r.nextSibling?i.insertBefore(e,r.nextSibling):i.appendChild(e):i.insertBefore(e,i.firstChild),y.push(e);else{if("bottom"!==t.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");i.appendChild(e)}}function o(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t);var e=y.indexOf(t);e>=0&&y.splice(e,1)}function a(t){var e=document.createElement("style");return t.attrs.type="text/css",c(e,t.attrs),s(t,e),e}function h(t){var e=document.createElement("link");return t.attrs.type="text/css",t.attrs.rel="stylesheet",c(e,t.attrs),s(t,e),e}function c(t,e){Object.keys(e).forEach(function(i){t.setAttribute(i,e[i])})}function u(t,e){var i,r,n,s;if(e.transform&&t.css){if(!(s=e.transform(t.css)))return function(){};t.css=s}if(e.singleton){var c=v++;i=b||(b=a(e)),r=l.bind(null,i,c,!1),n=l.bind(null,i,c,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(i=h(e),r=g.bind(null,i,e),n=function(){o(i),i.href&&URL.revokeObjectURL(i.href)}):(i=a(e),r=d.bind(null,i),n=function(){o(i)});return r(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;r(t=e)}else n()}}function l(t,e,i,r){var n=i?"":r.css;if(t.styleSheet)t.styleSheet.cssText=w(e,n);else{var s=document.createTextNode(n),o=t.childNodes;o[e]&&t.removeChild(o[e]),o.length?t.insertBefore(s,o[e]):t.appendChild(s)}}function d(t,e){var i=e.css,r=e.media;if(r&&t.setAttribute("media",r),t.styleSheet)t.styleSheet.cssText=i;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(i))}}function g(t,e,i){var r=i.css,n=i.sourceMap,s=void 0===e.convertToAbsoluteUrls&&n;(e.convertToAbsoluteUrls||s)&&(r=x(r)),n&&(r+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(n))))+" */");var o=new Blob([r],{type:"text/css"}),a=t.href;t.href=URL.createObjectURL(o),a&&URL.revokeObjectURL(a)}var p={},f=function(t){var e;return function(){return void 0===e&&(e=t.apply(this,arguments)),e}}(function(){return window&&document&&document.all&&!window.atob}),m=function(t){var e={};return function(i){return void 0===e[i]&&(e[i]=t.call(this,i)),e[i]}}(function(t){return document.querySelector(t)}),b=null,v=0,y=[],x=i(7);t.exports=function(t,e){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");e=e||{},e.attrs="object"==typeof e.attrs?e.attrs:{},e.singleton||(e.singleton=f()),e.insertInto||(e.insertInto="head"),e.insertAt||(e.insertAt="bottom");var i=n(t,e);return r(i,e),function(t){for(var s=[],o=0;o<i.length;o++){var a=i[o],h=p[a.id];h.refs--,s.push(h)}if(t){r(n(t,e),e)}for(var o=0;o<s.length;o++){var h=s[o];if(0===h.refs){for(var c=0;c<h.parts.length;c++)h.parts[c]();delete p[h.id]}}}};var w=function(){var t=[];return function(e,i){return t[e]=i,t.filter(Boolean).join("\n")}}()},function(t,e){t.exports=function(t){var e="undefined"!=typeof window&&window.location;if(!e)throw new Error("fixUrls requires window.location");if(!t||"string"!=typeof t)return t;var i=e.protocol+"//"+e.host,r=i+e.pathname.replace(/\/[^\/]*$/,"/");return t.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(t,e){var n=e.trim().replace(/^"(.*)"$/,function(t,e){return e}).replace(/^'(.*)'$/,function(t,e){return e});if(/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/)/i.test(n))return t;var s;return s=0===n.indexOf("//")?n:0===n.indexOf("/")?i+n:r+n.replace(/^\.\//,""),"url("+JSON.stringify(s)+")"})}},function(t,e,i){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.sinCity=e.clarity=e.lomo=e.vintage=void 0;var r=i(10),n="#img_ori";t.vintage=function(){(0,r.Caman)("#img_ori",function(){this.greyscale(),this.contrast(5),this.noise(3),this.sepia(100),this.channels({red:8,blue:2,green:4}),this.gamma(.87),this.render()})};var s=function(){(0,r.Caman)(n,function(){this.brightness(15),this.exposure(15),this.curves("rgb",[0,0],[200,0],[155,255],[255,255]),this.saturation(-20),this.gamma(1.8),this.render()})},o=function(){(0,r.Caman)(n,function(){this.vibrance(20),this.curves("rgb",[5,0],[130,150],[190,220],[250,255]),this.sharpen(15),this.vignette("45%",20),this.render()})},a=function(){(0,r.Caman)(n,function(){this.contrast(100),this.brightness(15),this.exposure(10),this.posterize(80),this.clip(30),this.greyscale(),this.render()})};e.vintage=vintage,e.lomo=s,e.clarity=o,e.sinCity=a}).call(e,i(9))},function(t,e){var i;i=function(){return this}();try{i=i||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(i=window)}t.exports=i},function(t,e,i){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};(function(){var t,n,s,o,a,h,c,u,l,d,g,p,f,m,b,v,y,x,w,D,R,M,L,P,S,I={}.hasOwnProperty,B=[].indexOf||function(t){for(var e=0,i=this.length;e<i;e++)if(e in this&&this[e]===t)return e;return-1},C=[].slice;P=Array.prototype.slice,t=function(t,i){return null==i&&(i=document),"object"===(void 0===t?"undefined":r(t))||void 0!==e&&null!==e?t:i.querySelector(t)},M=function(){function t(){}return t.uniqid=function(){var t;return t=0,{get:function(){return t++}}}(),t.extend=function(t){var e,i,r,n,s,o;for(i=t,n=P.call(arguments,1),s=0,o=n.length;s<o;s++){e=n[s];for(r in e)I.call(e,r)&&(i[r]=e[r])}return i},t.clampRGB=function(t){return t<0?0:t>255?255:t},t.copyAttributes=function(t,e,i){var r,n,s,o,a,h;for(null==i&&(i={}),o=t.attributes,h=[],n=0,s=o.length;n<s;n++)r=o[n],null!=i.except&&(a=r.nodeName,B.call(i.except,a)>=0)||h.push(e.setAttribute(r.nodeName,r.nodeValue));return h},t.dataArray=function(t){return null==t&&(t=0),a.NodeJS||null!=window.Uint8Array?new Uint8Array(t):new Array(t)},t}(),void 0!==e&&null!==e?(D=e,c=i(!function(){var t=new Error('Cannot find module "canvas"');throw t.code="MODULE_NOT_FOUND",t}()),f=c.Image,d=i(!function(){var t=new Error('Cannot find module "fibers"');throw t.code="MODULE_NOT_FOUND",t}()),L=i(!function(){var t=new Error('Cannot find module "fs"');throw t.code="MODULE_NOT_FOUND",t}())):D=window,D.Caman=a=function(){function i(){var t,e,r,s=this;if(0===arguments.length)throw"Invalid arguments";return this instanceof i?(this.finishInit=this.finishInit.bind(this),this.imageLoaded=this.imageLoaded.bind(this),t=arguments[0],i.NodeJS||(r=parseInt(i.getAttrId(t[0]),10),e="function"==typeof t[1]?t[1]:"function"==typeof t[2]?t[2]:function(){},isNaN(r)||!R.has(r))?(this.id=M.uniqid.get(),this.initializedPixelData=this.originalPixelData=null,this.cropCoordinates={x:0,y:0},this.cropped=!1,this.resized=!1,this.pixelStack=[],this.layerStack=[],this.canvasQueue=[],this.currentLayer=null,this.scaled=!1,this.analyze=new n(this),this.renderer=new w(this),this.domIsLoaded(function(){return s.parseArguments(t),s.setup()}),this):R.execute(r,e)):new i(arguments)}return i.version={release:"4.1.1",date:"4/8/2013"},i.DEBUG=!1,i.NodeJS=void 0!==e&&null!==e,i.autoload=!i.NodeJS,i.allowRevert=!0,i.crossOrigin="anonymous",i.toString=function(){return"Version "+i.version.release+", Released "+i.version.date},i.remoteProxy="",i.proxyParam="camanProxyUrl",i.getAttrId=function(e){return!!i.NodeJS||("string"==typeof e&&(e=t(e)),null==e||null==e.getAttribute?null:e.getAttribute("data-caman-id"))},i.prototype.domIsLoaded=function(t){var e,r=this;return i.NodeJS?setTimeout(function(){return t.call(r)},0):"complete"===document.readyState?(b.debug("DOM initialized"),setTimeout(function(){return t.call(r)},0)):(e=function(){if("complete"===document.readyState)return b.debug("DOM initialized"),t.call(r)},document.addEventListener("readystatechange",e,!1))},i.prototype.parseArguments=function(t){var e,i,n,s;if(0===t.length)throw"Invalid arguments given";if(this.initObj=null,this.initType=null,this.imageUrl=null,this.callback=function(){},this.setInitObject(t[0]),1!==t.length){switch(r(t[1])){case"string":this.imageUrl=t[1];break;case"function":this.callback=t[1]}if(2!==t.length&&(this.callback=t[2],4===t.length)){n=t[4],s=[];for(e in n)I.call(n,e)&&(i=n[e],s.push(this.options[e]=i));return s}}},i.prototype.setInitObject=function(e){if(i.NodeJS)return this.initObj=e,void(this.initType="node");if("object"===(void 0===e?"undefined":r(e))?this.initObj=e:this.initObj=t(e),null==this.initObj)throw"Could not find image or canvas for initialization.";return this.initType=this.initObj.nodeName.toLowerCase()},i.prototype.setup=function(){switch(this.initType){case"node":return this.initNode();case"img":return this.initImage();case"canvas":return this.initCanvas()}},i.prototype.initNode=function(){var t=this;return b.debug("Initializing for NodeJS"),this.image=new f,this.image.onload=function(){return b.debug("Image loaded. Width = "+t.imageWidth()+", Height = "+t.imageHeight()),t.canvas=new c(t.imageWidth(),t.imageHeight()),t.finishInit()},this.image.onerror=function(t){throw t},this.image.src=this.initObj},i.prototype.initImage=function(){return this.image=this.initObj,this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),M.copyAttributes(this.image,this.canvas,{except:["src"]}),this.image.parentNode.replaceChild(this.canvas,this.image),this.imageAdjustments(),this.waitForImageLoaded()},i.prototype.initCanvas=function(){return this.canvas=this.initObj,this.context=this.canvas.getContext("2d"),null!=this.imageUrl?(this.image=document.createElement("img"),this.image.src=this.imageUrl,this.imageAdjustments(),this.waitForImageLoaded()):this.finishInit()},i.prototype.imageAdjustments=function(){if(this.needsHiDPISwap()&&(b.debug(this.image.src,"->",this.hiDPIReplacement()),this.swapped=!0,this.image.src=this.hiDPIReplacement()),p.isRemote(this.image))return this.image.src=p.proxyUrl(this.image.src),b.debug("Remote image detected, using URL = "+this.image.src)},i.prototype.waitForImageLoaded=function(){return this.isImageLoaded()?this.imageLoaded():this.image.onload=this.imageLoaded},i.prototype.isImageLoaded=function(){return!!this.image.complete&&(null==this.image.naturalWidth||0!==this.image.naturalWidth)},i.prototype.imageWidth=function(){return this.image.width||this.image.naturalWidth},i.prototype.imageHeight=function(){return this.image.height||this.image.naturalHeight},i.prototype.imageLoaded=function(){return b.debug("Image loaded. Width = "+this.imageWidth()+", Height = "+this.imageHeight()),this.swapped?(this.canvas.width=this.imageWidth()/this.hiDPIRatio(),this.canvas.height=this.imageHeight()/this.hiDPIRatio()):(this.canvas.width=this.imageWidth(),this.canvas.height=this.imageHeight()),this.finishInit()},i.prototype.finishInit=function(){var t,e,r,n,s;if(null==this.context&&(this.context=this.canvas.getContext("2d")),this.originalWidth=this.preScaledWidth=this.width=this.canvas.width,this.originalHeight=this.preScaledHeight=this.height=this.canvas.height,this.hiDPIAdjustments(),this.hasId()||this.assignId(),null!=this.image&&this.context.drawImage(this.image,0,0,this.imageWidth(),this.imageHeight(),0,0,this.preScaledWidth,this.preScaledHeight),this.reloadCanvasData(),i.allowRevert)for(this.initializedPixelData=M.dataArray(this.pixelData.length),this.originalPixelData=M.dataArray(this.pixelData.length),s=this.pixelData,t=r=0,n=s.length;r<n;t=++r)e=s[t],this.initializedPixelData[t]=e,this.originalPixelData[t]=e;return this.dimensions={width:this.canvas.width,height:this.canvas.height},R.put(this.id,this),this.callback.call(this,this),this.callback=function(){}},i.prototype.reloadCanvasData=function(){return this.imageData=this.context.getImageData(0,0,this.canvas.width,this.canvas.height),this.pixelData=this.imageData.data},i.prototype.resetOriginalPixelData=function(){var t,e,r,n,s;if(!i.allowRevert)throw"Revert disabled";for(this.originalPixelData=M.dataArray(this.pixelData.length),n=this.pixelData,s=[],e=0,r=n.length;e<r;e++)t=n[e],s.push(this.originalPixelData.push(t));return s},i.prototype.hasId=function(){return null!=i.getAttrId(this.canvas)},i.prototype.assignId=function(){if(!i.NodeJS&&!this.canvas.getAttribute("data-caman-id"))return this.canvas.setAttribute("data-caman-id",this.id)},i.prototype.hiDPIDisabled=function(){return null!==this.canvas.getAttribute("data-caman-hidpi-disabled")},i.prototype.hiDPIAdjustments=function(){var t;if(!i.NodeJS&&!this.hiDPIDisabled())return t=this.hiDPIRatio(),1!==t?(b.debug("HiDPI ratio = "+t),this.scaled=!0,this.preScaledWidth=this.canvas.width,this.preScaledHeight=this.canvas.height,this.canvas.width=this.preScaledWidth*t,this.canvas.height=this.preScaledHeight*t,this.canvas.style.width=this.preScaledWidth+"px",this.canvas.style.height=this.preScaledHeight+"px",this.context.scale(t,t),this.width=this.originalWidth=this.canvas.width,this.height=this.originalHeight=this.canvas.height):void 0},i.prototype.hiDPIRatio=function(){var t,e;return e=window.devicePixelRatio||1,t=this.context.webkitBackingStorePixelRatio||this.context.mozBackingStorePixelRatio||this.context.msBackingStorePixelRatio||this.context.oBackingStorePixelRatio||this.context.backingStorePixelRatio||1,e/t},i.prototype.hiDPICapable=function(){return null!=window.devicePixelRatio&&1!==window.devicePixelRatio},i.prototype.needsHiDPISwap=function(){return!(this.hiDPIDisabled()||!this.hiDPICapable())&&null!==this.hiDPIReplacement()},i.prototype.hiDPIReplacement=function(){return null==this.image?null:this.image.getAttribute("data-caman-hidpi")},i.prototype.replaceCanvas=function(t){var e;return e=this.canvas,this.canvas=t,this.context=this.canvas.getContext("2d"),e.parentNode.replaceChild(this.canvas,e),this.width=this.canvas.width,this.height=this.canvas.height,this.reloadCanvasData(),this.dimensions={width:this.canvas.width,height:this.canvas.height}},i.prototype.render=function(t){var e=this;return null==t&&(t=function(){}),l.trigger(this,"renderStart"),this.renderer.execute(function(){return e.context.putImageData(e.imageData,0,0),t.call(e)})},i.prototype.revert=function(){var t,e,r,n,s;if(!i.allowRevert)throw"Revert disabled";for(s=this.originalVisiblePixels(),t=r=0,n=s.length;r<n;t=++r)e=s[t],this.pixelData[t]=e;return this.context.putImageData(this.imageData,0,0)},i.prototype.reset=function(){var t,e,i,r,n,s,o,a,h;for(t=document.createElement("canvas"),M.copyAttributes(this.canvas,t),t.width=this.originalWidth,t.height=this.originalHeight,e=t.getContext("2d"),r=e.getImageData(0,0,t.width,t.height),s=r.data,h=this.initializedPixelData,i=o=0,a=h.length;o<a;i=++o)n=h[i],s[i]=n;return e.putImageData(r,0,0),this.cropCoordinates={x:0,y:0},this.resized=!1,this.replaceCanvas(t)},i.prototype.originalVisiblePixels=function(){var t,e,r,n,s,o,a,h,c,u,l,d,g,p,f,m,b,v,x,w,D;if(!i.allowRevert)throw"Revert disabled";if(u=[],d=this.cropCoordinates.x,n=d+this.width,g=this.cropCoordinates.y,s=g+this.height,this.resized){for(t=document.createElement("canvas"),t.width=this.originalWidth,t.height=this.originalHeight,r=t.getContext("2d"),a=r.getImageData(0,0,t.width,t.height),c=a.data,v=this.originalPixelData,o=f=0,b=v.length;f<b;o=++f)h=v[o],c[o]=h;r.putImageData(a,0,0),l=document.createElement("canvas"),l.width=this.width,l.height=this.height,r=l.getContext("2d"),r.drawImage(t,0,0,this.originalWidth,this.originalHeight,0,0,this.width,this.height),c=r.getImageData(0,0,this.width,this.height).data,p=this.width}else c=this.originalPixelData,p=this.originalWidth;for(o=m=0,x=c.length;m<x;o=m+=4)e=y.locationToCoordinates(o,p),d<=(w=e.x)&&w<n&&g<=(D=e.y)&&D<s&&u.push(c[o],c[o+1],c[o+2],c[o+3]);return u},i.prototype.process=function(t,e){return this.renderer.add({type:g.Type.Single,name:t,processFn:e}),this},i.prototype.processKernel=function(t,e,i,r){var n,s,o;if(!i)for(i=0,n=s=0,o=e.length;0<=o?s<o:s>o;n=0<=o?++s:--s)i+=e[n];return this.renderer.add({type:g.Type.Kernel,name:t,adjust:e,divisor:i,bias:r||0}),this},i.prototype.processPlugin=function(t,e){return this.renderer.add({type:g.Type.Plugin,plugin:t,args:e}),this},i.prototype.newLayer=function(t){var e;return e=new m(this),this.canvasQueue.push(e),this.renderer.add({type:g.Type.LayerDequeue}),t.call(e),this.renderer.add({type:g.Type.LayerFinished}),this},i.prototype.executeLayer=function(t){return this.pushContext(t)},i.prototype.pushContext=function(t){return this.layerStack.push(this.currentLayer),this.pixelStack.push(this.pixelData),this.currentLayer=t,this.pixelData=t.pixelData},i.prototype.popContext=function(){return this.pixelData=this.pixelStack.pop(),this.currentLayer=this.layerStack.pop()},i.prototype.applyCurrentLayer=function(){return this.currentLayer.applyToParent()},i}(),n=function(){function t(t){this.c=t}return t.prototype.calculateLevels=function(){var t,e,i,r,n,s,o;for(e={r:{},g:{},b:{}},t=r=0;r<=255;t=++r)e.r[t]=0,e.g[t]=0,e.b[t]=0;for(t=n=0,o=this.c.pixelData.length;n<o;t=n+=4)e.r[this.c.pixelData[t]]++,e.g[this.c.pixelData[t+1]]++,e.b[this.c.pixelData[t+2]]++;for(i=this.c.pixelData.length/4,t=s=0;s<=255;t=++s)e.r[t]/=i,e.g[t]/=i,e.b[t]/=i;return e},t}(),a.DOMUpdated=function(){var t,e,i,r,n;if(e=document.querySelectorAll("img[data-caman]"),e.length>0){for(n=[],i=0,r=e.length;i<r;i++)t=e[i],n.push(new h(t,function(){return this.parse(),this.execute()}));return n}},a.autoload&&function(){"complete"===document.readyState?a.DOMUpdated():document.addEventListener("DOMContentLoaded",a.DOMUpdated,!1)}(),h=function(){function t(t,e){this.dataStr=t.getAttribute("data-caman"),this.caman=a(t,e.bind(this))}var e;return e="(\\w+)\\((.*?)\\)",t.prototype.parse=function(){var t,i,r,n,s,o,a,h,c,u,l;if(this.ele=this.caman.canvas,o=new RegExp(e,"g"),a=this.dataStr.match(o),a.length>0){for(o=new RegExp(e),l=[],h=0,c=a.length;h<c;h++){n=a[h],u=n.match(o),u[0],i=u[1],t=u[2],s=new Function("return function() {        this."+i+"("+t+");      };");try{r=s(),l.push(r.call(this.caman))}catch(t){l.push(b.debug(t))}}return l}},t.prototype.execute=function(){var t;return t=this.ele,this.caman.render(function(){return t.parentNode.replaceChild(this.toImage(),t)})},t}(),a.Blender=s=function(){function t(){}return t.blenders={},t.register=function(t,e){return this.blenders[t]=e},t.execute=function(t,e,i){return this.blenders[t](e,i)},t}(),a.Calculate=o=function(){function t(){}return t.distance=function(t,e,i,r){return Math.sqrt(Math.pow(i-t,2)+Math.pow(r-e,2))},t.randomRange=function(t,e,i){var r;return null==i&&(i=!1),r=t+Math.random()*(e-t),i?r.toFixed(i):Math.round(r)},t.luminance=function(t){return.299*t.r+.587*t.g+.114*t.b},t.bezier=function(t,e,i,r,n,s){var o,a,h,c,u,l,d,g,p,f,m,b,v,y,x,w,D,R,M,L,P,S,I,B,C,k,F;for(x=t[0],M=t[1],w=e[0],L=e[1],D=i[0],P=i[1],R=r[0],S=r[1],d={},u=parseInt(3*(w-x),10),h=3*(D-w)-u,o=R-x-u-h,l=3*(L-M),c=3*(P-L)-l,a=S-M-l-c,f=I=0;I<1e3;f=++I)y=f/1e3,g=Math.round(o*Math.pow(y,3)+h*Math.pow(y,2)+u*y+x),p=Math.round(a*Math.pow(y,3)+c*Math.pow(y,2)+l*y+M),n&&p<n?p=n:s&&p>s&&(p=s),d[g]=p;if(d.length<r[0]+1)for(f=B=0,k=r[0];0<=k?B<=k:B>=k;f=0<=k?++B:--B)if(null==d[f]){for(b=[f-1,d[f-1]],m=C=f,F=r[0];f<=F?C<=F:C>=F;m=f<=F?++C:--C)if(null!=d[m]){v=[m,d[m]];break}d[f]=b[1]+(v[1]-b[1])/(v[0]-b[0])*(f-b[0])}return null==d[r[0]]&&(d[r[0]]=d[r[0]-1]),d},t}(),u=function(){function t(){}return t.hexToRGB=function(t){var e,i,r;return"#"===t.charAt(0)&&(t=t.substr(1)),r=parseInt(t.substr(0,2),16),i=parseInt(t.substr(2,2),16),e=parseInt(t.substr(4,2),16),{r:r,g:i,b:e}},t.rgbToHSL=function(t,e,i){var n,s,o,a,h,c;return"object"===(void 0===t?"undefined":r(t))&&(e=t.g,i=t.b,t=t.r),t/=255,e/=255,i/=255,a=Math.max(t,e,i),h=Math.min(t,e,i),o=(a+h)/2,a===h?s=c=0:(n=a-h,c=o>.5?n/(2-a-h):n/(a+h),s=function(){switch(a){case t:return(e-i)/n+(e<i?6:0);case e:return(i-t)/n+2;case i:return(t-e)/n+4}}(),s/=6),{h:s,s:c,l:o}},t.hslToRGB=function(t,e,i){var n,s,o,a,h;return"object"===(void 0===t?"undefined":r(t))&&(e=t.s,i=t.l,t=t.h),0===e?h=s=n=i:(a=i<.5?i*(1+e):i+e-i*e,o=2*i-a,h=this.hueToRGB(o,a,t+1/3),s=this.hueToRGB(o,a,t),n=this.hueToRGB(o,a,t-1/3)),{r:255*h,g:255*s,b:255*n}},t.hueToRGB=function(t,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?t+6*(e-t)*i:i<.5?e:i<2/3?t+(e-t)*(2/3-i)*6:t},t.rgbToHSV=function(t,e,i){var r,n,s,o,a,h;return t/=255,e/=255,i/=255,s=Math.max(t,e,i),o=Math.min(t,e,i),h=s,r=s-o,a=0===s?0:r/s,s===o?n=0:(n=function(){switch(s){case t:return(e-i)/r+(e<i?6:0);case e:return(i-t)/r+2;case i:return(t-e)/r+4}}(),n/=6),{h:n,s:a,v:h}},t.hsvToRGB=function(t,e,i){var r,n,s,o,a,h,c,u;switch(o=Math.floor(6*t),n=6*t-o,a=i*(1-e),h=i*(1-n*e),u=i*(1-(1-n)*e),o%6){case 0:c=i,s=u,r=a;break;case 1:c=h,s=i,r=a;break;case 2:c=a,s=i,r=u;break;case 3:c=a,s=h,r=i;break;case 4:c=u,s=a,r=i;break;case 5:c=i,s=a,r=h}return{r:255*c,g:255*s,b:255*r}},t.rgbToXYZ=function(t,e,i){var r,n,s;return t/=255,e/=255,i/=255,t>.04045?t=Math.pow((t+.055)/1.055,2.4):t/=12.92,e>.04045?e=Math.pow((e+.055)/1.055,2.4):e/=12.92,i>.04045?i=Math.pow((i+.055)/1.055,2.4):i/=12.92,r=.4124*t+.3576*e+.1805*i,n=.2126*t+.7152*e+.0722*i,s=.0193*t+.1192*e+.9505*i,{x:100*r,y:100*n,z:100*s}},t.xyzToRGB=function(t,e,i){var r,n,s;return t/=100,e/=100,i/=100,s=3.2406*t+-1.5372*e+-.4986*i,n=-.9689*t+1.8758*e+.0415*i,r=.0557*t+-.204*e+1.057*i,s>.0031308?s=1.055*Math.pow(s,.4166666667)-.055:s*=12.92,n>.0031308?n=1.055*Math.pow(n,.4166666667)-.055:n*=12.92,r>.0031308?r=1.055*Math.pow(r,.4166666667)-.055:r*=12.92,{r:255*s,g:255*n,b:255*r}},t.xyzToLab=function(t,e,i){var n,s,o,a,h,c;return"object"===(void 0===t?"undefined":r(t))&&(e=t.y,i=t.z,t=t.x),a=95.047,h=100,c=108.883,t/=a,e/=h,i/=c,t=t>.008856451679?Math.pow(t,.3333333333):7.787037037*t+.1379310345,e=e>.008856451679?Math.pow(e,.3333333333):7.787037037*e+.1379310345,i=i>.008856451679?Math.pow(i,.3333333333):7.787037037*i+.1379310345,o=116*e-16,n=500*(t-e),s=200*(e-i),{l:o,a:n,b:s}},t.labToXYZ=function(t,e,i){var n,s,o;return"object"===(void 0===t?"undefined":r(t))&&(e=t.a,i=t.b,t=t.l),s=(t+16)/116,n=s+e/500,o=s-i/200,n>.2068965517?n*=n*n:n=.1284185493*(n-.1379310345),s>.2068965517?s*=s*s:s=.1284185493*(s-.1379310345),o>.2068965517?o*=o*o:o=.1284185493*(o-.1379310345),{x:95.047*n,y:100*s,z:108.883*o}},t.rgbToLab=function(t,e,i){var n;return"object"===(void 0===t?"undefined":r(t))&&(e=t.g,i=t.b,t=t.r),n=this.rgbToXYZ(t,e,i),this.xyzToLab(n)},t.labToRGB=function(t,e,i){},t}(),l=function(){function t(){}return t.events={},t.types=["processStart","processComplete","renderStart","renderFinished","blockStarted","blockFinished"],t.trigger=function(t,e,i){var r,n,s,o,a;if(this.events[e]&&this.events[e].length){for(o=this.events[e],a=[],n=0,s=o.length;n<s;n++)r=o[n],null===r.target||t.id===r.target.id?a.push(r.fn.call(t,i)):a.push(void 0);return a}},t.listen=function(t,e,i){var r,n;return"string"==typeof t&&(n=t,r=e,t=null,e=n,i=r),!(B.call(this.types,e)<0)&&(this.events[e]||(this.events[e]=[]),this.events[e].push({target:t,fn:i}),!0)},t}(),a.Event=l,a.Filter=g=function(){function t(){}return t.Type={Single:1,Kernel:2,LayerDequeue:3,LayerFinished:4,LoadOverlay:5,Plugin:6},t.register=function(t,e){return a.prototype[t]=e},t}(),a.IO=p=function(){function t(){}return t.domainRegex=/(?:(?:http|https):\/\/)((?:\w+)\.(?:(?:\w|\.)+))/,t.isRemote=function(t){return null!=t&&(!this.corsEnabled(t)&&this.isURLRemote(t.src))},t.corsEnabled=function(t){var e;return null!=t.crossOrigin&&("anonymous"===(e=t.crossOrigin.toLowerCase())||"use-credentials"===e)},t.isURLRemote=function(t){var e;return!!(e=t.match(this.domainRegex))&&e[1]!==document.domain},t.remoteCheck=function(t){if(this.isURLRemote(t)){if(a.remoteProxy.length)return a.isURLRemote(a.remoteProxy)?void b.info("Cannot use a remote proxy for loading images."):a.remoteProxy+"?camanProxyUrl="+encodeURIComponent(t);b.info("Attempting to load a remote image without a configured proxy. URL: "+t)}},t.proxyUrl=function(t){return a.remoteProxy+"?"+a.proxyParam+"="+encodeURIComponent(t)},t.useProxy=function(t){var e;return e={ruby:"rb",python:"py",perl:"pl",javascript:"js"},t=t.toLowerCase(),null!=e[t]&&(t=e[t]),"proxies/caman_proxy."+t},t}(),a.prototype.save=function(){return void 0!==e&&null!==e?this.nodeSave.apply(this,arguments):this.browserSave.apply(this,arguments)},a.prototype.browserSave=function(t){var e;return null==t&&(t="png"),t=t.toLowerCase(),e=this.toBase64(t).replace("image/"+t,"image/octet-stream"),document.location.href=e},a.prototype.nodeSave=function(t,e){var i;null==e&&(e=!0);try{if(i=L.statSync(t),i.isFile()&&!e)return!1}catch(e){b.debug("Creating output file "+t)}return L.writeFile(t,this.canvas.toBuffer(),function(){return b.debug("Finished writing to "+t)})},a.prototype.toImage=function(t){var e;return e=document.createElement("img"),e.src=this.toBase64(t),e.width=this.dimensions.width,e.height=this.dimensions.height,window.devicePixelRatio&&(e.width/=window.devicePixelRatio,e.height/=window.devicePixelRatio),e},a.prototype.toBase64=function(t){return null==t&&(t="png"),t=t.toLowerCase(),this.canvas.toDataURL("image/"+t)},m=function(){function i(t){this.c=t,this.filter=this.c,this.options={blendingMode:"normal",opacity:1},this.layerID=M.uniqid.get(),this.canvas=void 0!==e&&null!==e?new c:document.createElement("canvas"),this.canvas.width=this.c.dimensions.width,this.canvas.height=this.c.dimensions.height,this.context=this.canvas.getContext("2d"),this.context.createImageData(this.canvas.width,this.canvas.height),this.imageData=this.context.getImageData(0,0,this.canvas.width,this.canvas.height),this.pixelData=this.imageData.data}return i.prototype.newLayer=function(t){return this.c.newLayer.call(this.c,t)},i.prototype.setBlendingMode=function(t){return this.options.blendingMode=t,this},i.prototype.opacity=function(t){return this.options.opacity=t/100,this},i.prototype.copyParent=function(){var t,e,i,r;for(e=this.c.pixelData,t=i=0,r=this.c.pixelData.length;i<r;t=i+=4)this.pixelData[t]=e[t],this.pixelData[t+1]=e[t+1],this.pixelData[t+2]=e[t+2],this.pixelData[t+3]=e[t+3];return this},i.prototype.fillColor=function(){return this.c.fillColor.apply(this.c,arguments)},i.prototype.overlayImage=function(e){return"object"===(void 0===e?"undefined":r(e))?e=e.src:"string"==typeof e&&"#"===e[0]&&(e=t(e).src),e?(this.c.renderer.renderQueue.push({type:g.Type.LoadOverlay,src:e,layer:this}),this):this},i.prototype.applyToParent=function(){var t,e,i,r,n,o,a,h,c;for(i=this.c.pixelStack[this.c.pixelStack.length-1],e=this.c.pixelData,c=[],t=a=0,h=e.length;a<h;t=a+=4)o={r:i[t],g:i[t+1],b:i[t+2],a:i[t+3]},n={r:e[t],g:e[t+1],b:e[t+2],a:e[t+3]},r=s.execute(this.options.blendingMode,n,o),r.r=M.clampRGB(r.r),r.g=M.clampRGB(r.g),r.b=M.clampRGB(r.b),null==r.a&&(r.a=n.a),i[t]=o.r-(o.r-r.r)*(this.options.opacity*(r.a/255)),i[t+1]=o.g-(o.g-r.g)*(this.options.opacity*(r.a/255)),c.push(i[t+2]=o.b-(o.b-r.b)*(this.options.opacity*(r.a/255)));return c},i}(),v=function(){function t(){var t,e,i,r;for(r=["log","info","warn","error"],e=0,i=r.length;e<i;e++)t=r[e],this[t]=function(t){return function(){var e;if(e=1<=arguments.length?C.call(arguments,0):[],a.DEBUG)try{return console[t].apply(console,e)}catch(i){return console[t](e)}}}(t);this.debug=this.log}return t}(),b=new v,y=function(){function t(t){this.c=t,this.loc=0}return t.coordinatesToLocation=function(t,e,i){return 4*(e*i+t)},t.locationToCoordinates=function(t,e){var i,r;return r=Math.floor(t/(4*e)),i=t%(4*e)/4,{x:i,y:r}},t.prototype.locationXY=function(){var t,e;return e=this.c.dimensions.height-Math.floor(this.loc/(4*this.c.dimensions.width)),t=this.loc%(4*this.c.dimensions.width)/4,{x:t,y:e}},t.prototype.getPixelRelative=function(t,e){var i;return i=this.loc+4*this.c.dimensions.width*(-1*e)+4*t,i>this.c.pixelData.length||i<0?{r:0,g:0,b:0,a:0}:{r:this.c.pixelData[i],g:this.c.pixelData[i+1],b:this.c.pixelData[i+2],a:this.c.pixelData[i+3]}},t.prototype.putPixelRelative=function(t,e,i){if(this.loc+4*this.c.dimensions.width*(-1*e)+4*t,!(newLoc>this.c.pixelData.length||newLoc<0))return this.c.pixelData[newLoc]=i.r,this.c.pixelData[newLoc+1]=i.g,this.c.pixelData[newLoc+2]=i.b,this.c.pixelData[newLoc+3]=i.a,!0},t.prototype.getPixel=function(t,e){var i;return i=this.coordinatesToLocation(t,e,this.width),{r:this.c.pixelData[i],g:this.c.pixelData[i+1],b:this.c.pixelData[i+2],a:this.c.pixelData[i+3]}},t.prototype.putPixel=function(t,e,i){var r;return r=this.coordinatesToLocation(t,e,this.width),this.c.pixelData[r]=i.r,this.c.pixelData[r+1]=i.g,this.c.pixelData[r+2]=i.b,this.c.pixelData[r+3]=i.a},t}(),x=function(){function t(){}return t.plugins={},t.register=function(t,e){return this.plugins[t]=e},t.execute=function(t,e,i){return this.plugins[e].apply(t,i)},t}(),a.Plugin=x,a.Renderer=w=function(){function t(e){var i=this;this.c=e,this.processNext=function(){return t.prototype.processNext.apply(i,arguments)},this.renderQueue=[],this.modPixelData=null}return t.Blocks=a.NodeJS?i(11).cpus().length:4,t.prototype.add=function(t){if(null!=t)return this.renderQueue.push(t)},t.prototype.processNext=function(){var t;if(0===this.renderQueue.length)return l.trigger(this,"renderFinished"),null!=this.finishedFn&&this.finishedFn.call(this.c),this;switch(this.currentJob=this.renderQueue.shift(),this.currentJob.type){case g.Type.LayerDequeue:return t=this.c.canvasQueue.shift(),this.c.executeLayer(t),this.processNext();case g.Type.LayerFinished:return this.c.applyCurrentLayer(),this.c.popContext(),this.processNext();case g.Type.LoadOverlay:return this.loadOverlay(this.currentJob.layer,this.currentJob.src);case g.Type.Plugin:return this.executePlugin();default:return this.executeFilter()}},t.prototype.execute=function(t){return this.finishedFn=t,this.modPixelData=M.dataArray(this.c.pixelData.length),this.processNext()},t.prototype.eachBlock=function(e){var i,r,n,s,o,h,c,u,l,g,p,f,m=this;for(this.blocksDone=0,u=this.c.pixelData.length,r=Math.floor(u/4/t.Blocks),i=4*r,c=i+u/4%t.Blocks*4,f=[],h=g=0,p=t.Blocks;0<=p?g<p:g>p;h=0<=p?++g:--g)l=h*i,s=l+(h===t.Blocks-1?c:i),a.NodeJS?(o=d(function(){return e.call(m,h,l,s)}),n=o.run(),f.push(this.blockFinished(n))):f.push(setTimeout(function(t,i,r){return function(){return e.call(m,t,i,r)}}(h,l,s),0));return f},t.prototype.executeFilter=function(){return l.trigger(this.c,"processStart",this.currentJob),this.currentJob.type===g.Type.Single?this.eachBlock(this.renderBlock):this.eachBlock(this.renderKernel)},t.prototype.executePlugin=function(){return b.debug("Executing plugin "+this.currentJob.plugin),x.execute(this.c,this.currentJob.plugin,this.currentJob.args),b.debug("Plugin "+this.currentJob.plugin+" finished!"),this.processNext()},t.prototype.renderBlock=function(e,i,r){var n,s,o,h,c;for(b.debug("Block #"+e+" - Filter: "+this.currentJob.name+", Start: "+i+", End: "+r),l.trigger(this.c,"blockStarted",{blockNum:e,totalBlocks:t.Blocks,startPixel:i,endPixel:r}),n={r:0,g:0,b:0,a:0},o=new y(this.c),s=c=i;c<r;s=c+=4)o.loc=s,n.r=this.c.pixelData[s],n.g=this.c.pixelData[s+1],n.b=this.c.pixelData[s+2],n.a=this.c.pixelData[s+3],h=this.currentJob.processFn.call(o,n),null==h.a&&(h.a=n.a),this.c.pixelData[s]=M.clampRGB(h.r),this.c.pixelData[s+1]=M.clampRGB(h.g),this.c.pixelData[s+2]=M.clampRGB(h.b),this.c.pixelData[s+3]=M.clampRGB(h.a);return a.NodeJS?d.yield(e):this.blockFinished(e)},t.prototype.renderKernel=function(t,e,i){var r,n,s,o,h,c,u,l,g,p,f,m,v,x,w,D,R;for(this.currentJob.name,s=this.currentJob.bias,c=this.currentJob.divisor,f=this.c.pixelData.length,r=this.currentJob.adjust,n=Math.sqrt(r.length),p=[],b.debug("Rendering kernel - Filter: "+this.currentJob.name),e=Math.max(e,4*this.c.dimensions.width*((n-1)/2)),i=Math.min(i,f-4*this.c.dimensions.width*((n-1)/2)),o=(n-1)/2,v=new y(this.c),u=w=e;w<i;u=w+=4){for(v.loc=u,h=0,l=D=-o;-o<=o?D<=o:D>=o;l=-o<=o?++D:--D)for(g=R=o;o<=-o?R<=-o:R>=-o;g=o<=-o?++R:--R)m=v.getPixelRelative(l,g),p[3*h]=m.r,p[3*h+1]=m.g,p[3*h+2]=m.b,h++;x=this.processKernel(r,p,c,s),this.modPixelData[u]=M.clampRGB(x.r),this.modPixelData[u+1]=M.clampRGB(x.g),this.modPixelData[u+2]=M.clampRGB(x.b),this.modPixelData[u+3]=this.c.pixelData[u+3]}return a.NodeJS?d.yield(t):this.blockFinished(t)},t.prototype.blockFinished=function(e){var i,r,n;if(e>=0&&b.debug("Block #"+e+" finished! Filter: "+this.currentJob.name),this.blocksDone++,l.trigger(this.c,"blockFinished",{blockNum:e,blocksFinished:this.blocksDone,totalBlocks:t.Blocks}),this.blocksDone===t.Blocks){if(this.currentJob.type===g.Type.Kernel)for(i=r=0,n=this.c.pixelData.length;0<=n?r<n:r>n;i=0<=n?++r:--r)this.c.pixelData[i]=this.modPixelData[i];return e>=0&&b.debug("Filter "+this.currentJob.name+" finished!"),l.trigger(this.c,"processComplete",this.currentJob),this.processNext()}},t.prototype.processKernel=function(t,e,i,r){var n,s,o,a;for(s={r:0,g:0,b:0},n=o=0,a=t.length;0<=a?o<a:o>a;n=0<=a?++o:--o)s.r+=t[n]*e[3*n],s.g+=t[n]*e[3*n+1],s.b+=t[n]*e[3*n+2];return s.r=s.r/i+r,s.g=s.g/i+r,s.b=s.b/i+r,s},t.prototype.loadOverlay=function(t,e){var i,r,n=this;return i=document.createElement("img"),i.onload=function(){return t.context.drawImage(i,0,0,n.c.dimensions.width,n.c.dimensions.height),t.imageData=t.context.getImageData(0,0,n.c.dimensions.width,n.c.dimensions.height),t.pixelData=t.imageData.data,n.c.pixelData=t.pixelData,n.processNext()},r=p.remoteCheck(e),i.src=null!=r?r:e},t}(),a.Store=R=function(){function t(){}return t.items={},t.has=function(t){return null!=this.items[t]},t.get=function(t){return this.items[t]},t.put=function(t,e){return this.items[t]=e},t.execute=function(t,e){var i=this;return setTimeout(function(){return e.call(i.get(t),i.get(t))},0),this.get(t)},t.flush=function(t){return null==t&&(t=!1),t?delete this.items[t]:this.items={}},t}(),s.register("normal",function(t,e){return{r:t.r,g:t.g,b:t.b}}),s.register("multiply",function(t,e){return{r:t.r*e.r/255,g:t.g*e.g/255,b:t.b*e.b/255}}),s.register("screen",function(t,e){return{r:255-(255-t.r)*(255-e.r)/255,g:255-(255-t.g)*(255-e.g)/255,b:255-(255-t.b)*(255-e.b)/255}}),s.register("overlay",function(t,e){var i;return i={},i.r=e.r>128?255-2*(255-t.r)*(255-e.r)/255:e.r*t.r*2/255,i.g=e.g>128?255-2*(255-t.g)*(255-e.g)/255:e.g*t.g*2/255,i.b=e.b>128?255-2*(255-t.b)*(255-e.b)/255:e.b*t.b*2/255,i}),s.register("difference",function(t,e){return{r:t.r-e.r,g:t.g-e.g,b:t.b-e.b}}),s.register("addition",function(t,e){return{r:e.r+t.r,g:e.g+t.g,b:e.b+t.b}}),s.register("exclusion",function(t,e){return{r:128-2*(e.r-128)*(t.r-128)/255,g:128-2*(e.g-128)*(t.g-128)/255,b:128-2*(e.b-128)*(t.b-128)/255}}),s.register("softLight",function(t,e){var i;return i={},i.r=e.r>128?255-(255-e.r)*(255-(t.r-128))/255:e.r*(t.r+128)/255,i.g=e.g>128?255-(255-e.g)*(255-(t.g-128))/255:e.g*(t.g+128)/255,i.b=e.b>128?255-(255-e.b)*(255-(t.b-128))/255:e.b*(t.b+128)/255,i}),s.register("lighten",function(t,e){return{r:e.r>t.r?e.r:t.r,g:e.g>t.g?e.g:t.g,b:e.b>t.b?e.b:t.b}}),s.register("darken",function(t,e){return{r:e.r>t.r?t.r:e.r,g:e.g>t.g?t.g:e.g,b:e.b>t.b?t.b:e.b}}),g.register("fillColor",function(){var t;return t=1===arguments.length?u.hexToRGB(arguments[0]):{r:arguments[0],g:arguments[1],b:arguments[2]},this.process("fillColor",function(e){return e.r=t.r,e.g=t.g,e.b=t.b,e.a=255,e})}),g.register("brightness",function(t){return t=Math.floor(t/100*255),this.process("brightness",function(e){return e.r+=t,e.g+=t,e.b+=t,e})}),g.register("saturation",function(t){return t*=-.01,this.process("saturation",function(e){var i;return i=Math.max(e.r,e.g,e.b),e.r!==i&&(e.r+=(i-e.r)*t),e.g!==i&&(e.g+=(i-e.g)*t),e.b!==i&&(e.b+=(i-e.b)*t),e})}),g.register("vibrance",function(t){return t*=-1,this.process("vibrance",function(e){var i,r,n;return n=Math.max(e.r,e.g,e.b),r=(e.r+e.g+e.b)/3,i=2*Math.abs(n-r)/255*t/100,e.r!==n&&(e.r+=(n-e.r)*i),e.g!==n&&(e.g+=(n-e.g)*i),e.b!==n&&(e.b+=(n-e.b)*i),e})}),g.register("greyscale",function(t){return this.process("greyscale",function(t){var e;return e=o.luminance(t),t.r=e,t.g=e,t.b=e,t})}),g.register("contrast",function(t){return t=Math.pow((t+100)/100,2),this.process("contrast",function(e){return e.r/=255,e.r-=.5,e.r*=t,e.r+=.5,e.r*=255,e.g/=255,e.g-=.5,e.g*=t,e.g+=.5,e.g*=255,e.b/=255,e.b-=.5,e.b*=t,e.b+=.5,e.b*=255,e})}),g.register("hue",function(t){return this.process("hue",function(e){var i,r,n;return r=u.rgbToHSV(e.r,e.g,e.b),i=100*r.h,i+=Math.abs(t),i%=100,i/=100,r.h=i,n=u.hsvToRGB(r.h,r.s,r.v),n.a=e.a,n})}),g.register("colorize",function(){var t,e;return 2===arguments.length?(e=u.hexToRGB(arguments[0]),t=arguments[1]):4===arguments.length&&(e={r:arguments[0],g:arguments[1],b:arguments[2]},t=arguments[3]),this.process("colorize",function(i){return i.r-=(i.r-e.r)*(t/100),i.g-=(i.g-e.g)*(t/100),i.b-=(i.b-e.b)*(t/100),i})}),g.register("invert",function(){return this.process("invert",function(t){return t.r=255-t.r,t.g=255-t.g,t.b=255-t.b,t})}),g.register("sepia",function(t){return null==t&&(t=100),t/=100,this.process("sepia",function(e){return e.r=Math.min(255,e.r*(1-.607*t)+e.g*(.769*t)+e.b*(.189*t)),e.g=Math.min(255,e.r*(.349*t)+e.g*(1-.314*t)+e.b*(.168*t)),e.b=Math.min(255,e.r*(.272*t)+e.g*(.534*t)+e.b*(1-.869*t)),e})}),g.register("gamma",function(t){return this.process("gamma",function(e){return e.r=255*Math.pow(e.r/255,t),e.g=255*Math.pow(e.g/255,t),e.b=255*Math.pow(e.b/255,t),e})}),g.register("noise",function(t){return t=2.55*Math.abs(t),this.process("noise",function(e){var i;return i=o.randomRange(-1*t,t),e.r+=i,e.g+=i,e.b+=i,e})}),g.register("clip",function(t){return t=2.55*Math.abs(t),this.process("clip",function(e){return e.r>255-t?e.r=255:e.r<t&&(e.r=0),e.g>255-t?e.g=255:e.g<t&&(e.g=0),e.b>255-t?e.b=255:e.b<t&&(e.b=0),e})}),g.register("channels",function(t){var e,i;if("object"!==(void 0===t?"undefined":r(t)))return this;for(e in t)I.call(t,e)&&(i=t[e],0!==i?t[e]/=100:delete t[e]);return 0===t.length?this:this.process("channels",function(e){return null!=t.red&&(t.red>0?e.r+=(255-e.r)*t.red:e.r-=e.r*Math.abs(t.red)),null!=t.green&&(t.green>0?e.g+=(255-e.g)*t.green:e.g-=e.g*Math.abs(t.green)),null!=t.blue&&(t.blue>0?e.b+=(255-e.b)*t.blue:e.b-=e.b*Math.abs(t.blue)),e})}),g.register("curves",function(){var t,e,i,r,n,s,a,h,c,u,l,d;if(e=arguments[0],i=2<=arguments.length?C.call(arguments,1):[],"string"==typeof e&&(e=e.split("")),"v"===e[0]&&(e=["r","g","b"]),i.length<3||i.length>4)throw"Invalid number of arguments to curves filter";if(h=i[0],r=i[1],n=4===i.length?i[2]:i[1],s=i[i.length-1],t=o.bezier(h,r,n,s,0,255),h[0]>0)for(a=c=0,l=h[0];0<=l?c<l:c>l;a=0<=l?++c:--c)t[a]=h[1];if(s[0]<255)for(a=u=d=s[0];d<=255?u<=255:u>=255;a=d<=255?++u:--u)t[a]=s[1];return this.process("curves",function(i){var r,n;for(a=r=0,n=e.length;0<=n?r<n:r>n;a=0<=n?++r:--r)i[e[a]]=t[i[e[a]]];return i})}),g.register("exposure",function(t){var e,i,r;return r=Math.abs(t)/100,e=[0,255*r],i=[255-255*r,255],t<0&&(e=e.reverse(),i=i.reverse()),this.curves("rgb",[0,0],e,i,[255,255])}),a.Plugin.register("crop",function(t,i,r,n){var s,o;return null==r&&(r=0),null==n&&(n=0),void 0!==e&&null!==e?s=new c(t,i):(s=document.createElement("canvas"),M.copyAttributes(this.canvas,s),s.width=t,s.height=i),o=s.getContext("2d"),o.drawImage(this.canvas,r,n,t,i,0,0,t,i),this.cropCoordinates={x:r,y:n},this.cropped=!0,this.replaceCanvas(s)}),a.Plugin.register("resize",function(t){var i,r;return null==t&&(t=null),null===t||null==t.width&&null==t.height?void b.error("Invalid or missing dimensions given for resize"):(null==t.width?t.width=this.canvas.width*t.height/this.canvas.height:null==t.height&&(t.height=this.canvas.height*t.width/this.canvas.width),void 0!==e&&null!==e?i=new c(t.width,t.height):(i=document.createElement("canvas"),M.copyAttributes(this.canvas,i),i.width=t.width,i.height=t.height),r=i.getContext("2d"),r.drawImage(this.canvas,0,0,this.canvas.width,this.canvas.height,0,0,t.width,t.height),this.resized=!0,this.replaceCanvas(i))}),a.Filter.register("crop",function(){return this.processPlugin("crop",Array.prototype.slice.call(arguments,0))}),a.Filter.register("resize",function(){return this.processPlugin("resize",Array.prototype.slice.call(arguments,0))}),a.Filter.register("boxBlur",function(){return this.processKernel("Box Blur",[1,1,1,1,1,1,1,1,1])}),a.Filter.register("heavyRadialBlur",function(){return this.processKernel("Heavy Radial Blur",[0,0,1,0,0,0,1,1,1,0,1,1,1,1,1,0,1,1,1,0,0,0,1,0,0])}),a.Filter.register("gaussianBlur",function(){return this.processKernel("Gaussian Blur",[1,4,6,4,1,4,16,24,16,4,6,24,36,24,6,4,16,24,16,4,1,4,6,4,1])}),a.Filter.register("motionBlur",function(t){var e;return e=0===t||180===t?[0,0,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,0,0]:t>0&&t<90||t>180&&t<270?[0,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,0]:90===t||270===t?[0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0]:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1],this.processKernel("Motion Blur",e)}),a.Filter.register("sharpen",function(t){return null==t&&(t=100),t/=100,this.processKernel("Sharpen",[0,-t,0,-t,4*t+1,-t,0,-t,0])}),S={brightness:function(t,e,i){return t.r=t.r-t.r*e*i.strength,t.g=t.g-t.g*e*i.strength,t.b=t.b-t.b*e*i.strength,t},gamma:function(t,e,i){return t.r=255*Math.pow(t.r/255,Math.max(10*e*i.strength,1)),t.g=255*Math.pow(t.g/255,Math.max(10*e*i.strength,1)),t.b=255*Math.pow(t.b/255,Math.max(10*e*i.strength,1)),t},colorize:function(t,e,i){return t.r-=(t.r-i.color.r)*e,t.g-=(t.g-i.color.g)*e,t.b-=(t.b-i.color.b)*e,t}},g.register("vignette",function(t,e){var i,r,n,s;return null==e&&(e=60),"string"==typeof t&&"%"===t.substr(-1)&&(t=this.dimensions.height>this.dimensions.width?this.dimensions.width*(parseInt(t.substr(0,t.length-1),10)/100):this.dimensions.height*(parseInt(t.substr(0,t.length-1),10)/100)),e/=100,r=[this.dimensions.width/2,this.dimensions.height/2],s=Math.sqrt(Math.pow(r[0],2)+Math.pow(r[1],2)),n=s-t,i=o.bezier([0,1],[30,30],[70,60],[100,80]),this.process("vignette",function(s){var a,h,c;return c=this.locationXY(),a=o.distance(c.x,c.y,r[0],r[1]),a>n&&(h=Math.max(1,i[Math.round((a-n)/t*100)]/10*e),s.r=255*Math.pow(s.r/255,h),s.g=255*Math.pow(s.g/255,h),s.b=255*Math.pow(s.b/255,h)),s})}),g.register("rectangularVignette",function(t){var e,i,n,s,h,c,l;if(e={strength:50,cornerRadius:0,method:"brightness",color:{r:0,g:0,b:0}},t=M.extend(e,t),!t.size)return this;if("string"==typeof t.size)n=parseInt(t.size,10)/100,t.size={width:this.dimensions.width*n,height:this.dimensions.height*n};else if("object"===r(t.size))for(l=["width","height"],h=0,c=l.length;h<c;h++)i=l[h],"string"==typeof t.size[i]&&(t.size[i]=this.dimensions[i]*(parseInt(t.size[i],10)/100));else"number"===t.size&&(s=t.size,t.size={width:s,height:s});return"string"==typeof t.cornerRadius&&(t.cornerRadius=t.size.width/2*(parseInt(t.cornerRadius,10)/100)),t.strength/=100,t.size.width=Math.floor(t.size.width),t.size.height=Math.floor(t.size.height),t.image={width:this.dimensions.width,height:this.dimensions.height},"colorize"===t.method&&"string"==typeof t.color&&(t.color=u.hexToRGB(t.color)),t.coords={left:(this.dimensions.width-t.size.width)/2,right:this.dimensions.width-t.coords.left,bottom:(this.dimensions.height-t.size.height)/2,top:this.dimensions.height-t.coords.bottom},t.corners=[{x:t.coords.left+t.cornerRadius,y:t.coords.top-t.cornerRadius},{x:t.coords.right-t.cornerRadius,y:t.coords.top-t.cornerRadius},{x:t.coords.right-t.cornerRadius,y:t.coords.bottom+t.cornerRadius},{x:t.coords.left+t.cornerRadius,y:t.coords.bottom+t.cornerRadius}],t.maxDist=o.distance(0,0,t.corners[3].x,t.corners[3].y)-t.cornerRadius,this.process("rectangularVignette",function(e){var i,r,n;return r=this.locationXY(),r.x>t.corners[0].x&&r.x<t.corners[1].x&&r.y>t.coords.bottom&&r.y<t.coords.top?e:r.x>t.coords.left&&r.x<t.coords.right&&r.y>t.corners[3].y&&r.y<t.corners[2].y?e:(r.x>t.corners[0].x&&r.x<t.corners[1].x&&r.y>t.coords.top?i=(r.y-t.coords.top)/t.maxDist:r.y>t.corners[2].y&&r.y<t.corners[1].y&&r.x>t.coords.right?i=(r.x-t.coords.right)/t.maxDist:r.x>t.corners[0].x&&r.x<t.corners[1].x&&r.y<t.coords.bottom?i=(t.coords.bottom-r.y)/t.maxDist:r.y>t.corners[2].y&&r.y<t.corners[1].y&&r.x<t.coords.left?i=(t.coords.left-r.x)/t.maxDist:r.x<=t.corners[0].x&&r.y>=t.corners[0].y?(n=a.distance(r.x,r.y,t.corners[0].x,t.corners[0].y),i=(n-t.cornerRadius)/t.maxDist):r.x>=t.corners[1].x&&r.y>=t.corners[1].y?(n=a.distance(r.x,r.y,t.corners[1].x,t.corners[1].y),i=(n-t.cornerRadius)/t.maxDist):r.x>=t.corners[2].x&&r.y<=t.corners[2].y?(n=a.distance(r.x,r.y,t.corners[2].x,t.corners[2].y),i=(n-t.cornerRadius)/t.maxDist):r.x<=t.corners[3].x&&r.y<=t.corners[3].y&&(n=a.distance(r.x,r.y,t.corners[3].x,t.corners[3].y),i=(n-t.cornerRadius)/t.maxDist),i<0?e:S[t.method](e,i,t))})}),function(){var t,i,r,n,s;n=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],s=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24],i=function(t,i,r,n,s,o,a){var h,u,l,d,g,p,f;return h=void 0!==e&&null!==e?new c:document.createElement("canvas"),h.width=t,h.height=i,d=r+Math.cos(s)*o*.5,p=n+Math.sin(s)*o*.5,g=r-Math.cos(s)*o*.5,f=n-Math.sin(s)*o*.5,u=h.getContext("2d"),l=u.createLinearGradient(d,p,g,f),a?(l.addColorStop(0,"white"),l.addColorStop(.5,"black"),l.addColorStop(1,"white")):(l.addColorStop(0,"white"),l.addColorStop(1,"black")),u.fillStyle=l,u.fillRect(0,0,t,i),u.getImageData(0,0,t,i)},r=function(t,i,r,n,s,o){var a,h,u;return a=void 0!==e&&null!==e?new c:document.createElement("canvas"),a.width=t,a.height=i,h=a.getContext("2d"),u=h.createRadialGradient(r,n,s,r,n,o),u.addColorStop(1,"white"),u.addColorStop(0,"black"),h.fillStyle=u,h.fillRect(0,0,t,i),h.getImageData(0,0,t,i)},t=function(){return this.r=0,this.g=0,this.b=0,this.a=0,this.next=null},a.Plugin.register("compoundBlur",function(e,i,r,o){var a,h,c,u,l,d,g,p,f,m,b,v,y,x,w,D,R,M,L,P,S,I,B,C,k,F,T,A,z,O,N,U,E,j,J,H,G,W,_,K,q,V,X,Q,Y,Z,$,tt,et,it,rt,nt,st,ot,at,ht,ct;for(q=this.dimensions.width,m=this.dimensions.height,w=this.pixelData,A=e.data,_=q*m,K=_<<2,B=[],v=tt=0;0<=K?tt<K:tt>K;v=0<=K?++tt:--tt)B[v]=w[v];for(l=0,G=o,o-=1;G-- >=0;)if(0!==(R=i+.5|0)){for(R>256&&(R=256),d=R+R+1,q<<2,V=q-1,b=m-1,z=R+1,W=z*(z+1)/2,H=new t,E=void 0,U=H,v=et=1;1<=d?et<d:et>d;v=1<=d?++et:--et)U=U.next=new t,v===z&&(E=U);for(U.next=H,j=null,J=null,$=Y=0,L=n[R],N=s[R],Q=it=0;0<=m?it<m:it>m;Q=0<=m?++it:--it){for(k=g=a=T=f=c=0,F=z*(C=B[Y]),p=z*(I=B[Y+1]),h=z*(S=B[Y+2]),T+=W*C,f+=W*I,c+=W*S,U=H,v=rt=0;0<=z?rt<z:rt>z;v=0<=z?++rt:--rt)U.r=C,U.g=I,U.b=S,U=U.next;for(v=nt=1;1<=z?nt<z:nt>z;v=1<=z?++nt:--nt)P=Y+((V<v?V:v)<<2),T+=(U.r=C=B[P])*(O=z-v),f+=(U.g=I=B[P+1])*O,c+=(U.b=S=B[P+2])*O,k+=C,g+=I,a+=S,U=U.next;for(j=H,J=E,X=st=0;0<=q?st<q:st>q;X=0<=q?++st:--st)B[Y]=T*L>>N,B[Y+1]=f*L>>N,B[Y+2]=c*L>>N,T-=F,f-=p,c-=h,F-=j.r,p-=j.g,h-=j.b,P=$+((P=X+z)<V?P:V)<<2,k+=j.r=B[P],g+=j.g=B[P+1],a+=j.b=B[P+2],T+=k,f+=g,c+=a,j=j.next,F+=C=J.r,p+=I=J.g,h+=S=J.b,k-=C,g-=I,a-=S,J=J.next,Y+=4;$+=q}for(X=ot=0;0<=q?ot<q:ot>q;X=0<=q?++ot:--ot){for(g=a=k=f=c=T=0,Y=X<<2,F=z*(C=B[Y]),p=z*(I=B[Y+1]),h=z*(S=B[Y+2]),T+=W*C,f+=W*I,c+=W*S,U=H,v=at=0;0<=z?at<z:at>z;v=0<=z?++at:--at)U.r=C,U.g=I,U.b=S,U=U.next;for(Z=q,v=ht=1;1<=z?ht<z:ht>z;v=1<=z?++ht:--ht)Y=Z+X<<2,T+=(U.r=C=B[Y])*(O=z-v),f+=(U.g=I=B[Y+1])*O,c+=(U.b=S=B[Y+2])*O,k+=C,g+=I,a+=S,U=U.next,v<b&&(Z+=q);for(Y=X,j=H,J=E,Q=ct=0;0<=m?ct<m:ct>m;Q=0<=m?++ct:--ct)P=Y<<2,B[P]=T*L>>N,B[P+1]=f*L>>N,B[P+2]=c*L>>N,T-=F,f-=p,c-=h,F-=j.r,p-=j.g,h-=j.b,P=X+((P=Q+z)<b?P:b)*q<<2,T+=k+=j.r=B[P],f+=g+=j.g=B[P+1],c+=a+=j.b=B[P+2],j=j.next,F+=C=J.r,p+=I=J.g,h+=S=J.b,k-=C,g-=I,a-=S,J=J.next,Y+=q}for(i*=r,v=_;--v>-1;)x=v<<2,M=(255&A[x+2])/255*o,D=0|M,D===l?(u=256*(M-(0|M)),y=256-u,w[x]=w[x]*y+B[x]*u>>8,w[x+1]=w[x+1]*y+B[x+1]*u>>8,w[x+2]=w[x+2]*y+B[x+2]*u>>8):D===l+1&&(w[x]=B[x],w[x+1]=B[x+1],w[x+2]=B[x+2]);l++}return this}),a.Filter.register("tiltShift",function(t){var e,r;return e={center:{x:this.dimensions.width/2,y:this.dimensions.height/2},angle:45,focusWidth:200,startRadius:3,radiusFactor:1.5,steps:3},t=M.extend(e,t),t.angle*=Math.PI/180,r=i(this.dimensions.width,this.dimensions.height,t.center.x,t.center.y,t.angle,t.focusWidth,!0),this.processPlugin("compoundBlur",[r,t.startRadius,t.radiusFactor,t.steps])}),a.Filter.register("radialBlur",function(t){var e,i,n,s;return e={size:50,center:{x:this.dimensions.width/2,y:this.dimensions.height/2},startRadius:3,radiusFactor:1.5,steps:3,radius:null},t=M.extend(e,t),t.radius||(t.radius=this.dimensions.width<this.dimensions.height?this.dimensions.height:this.dimensions.width),n=t.radius/2-t.size,s=t.radius/2,i=r(this.dimensions.width,this.dimensions.height,t.center.x,t.center.y,n,s),this.processPlugin("compoundBlur",[i,t.startRadius,t.radiusFactor,t.steps])})}(),a.Filter.register("edgeEnhance",function(){return this.processKernel("Edge Enhance",[0,0,0,-1,1,0,0,0,0])}),a.Filter.register("edgeDetect",function(){return this.processKernel("Edge Detect",[-1,-1,-1,-1,8,-1,-1,-1,-1])}),a.Filter.register("emboss",function(){return this.processKernel("Emboss",[-2,-1,0,-1,1,1,0,1,2])}),a.Filter.register("posterize",function(t){var e,i;return e=256/t,i=255/(t-1),this.process("posterize",function(t){return t.r=Math.floor(Math.floor(t.r/e)*i),t.g=Math.floor(Math.floor(t.g/e)*i),t.b=Math.floor(Math.floor(t.b/e)*i),t})}),a.Filter.register("vintage",function(t){if(null==t&&(t=!0),this.greyscale(),this.contrast(5),this.noise(3),this.sepia(100),this.channels({red:8,blue:2,green:4}),this.gamma(.87),t)return this.vignette("40%",30)}),a.Filter.register("lomo",function(t){return null==t&&(t=!0),this.brightness(15),this.exposure(15),this.curves("rgb",[0,0],[200,0],[155,255],[255,255]),this.saturation(-20),this.gamma(1.8),t&&this.vignette("50%",60),this.brightness(5)}),a.Filter.register("clarity",function(t){return null==t&&(t=!1),this.vibrance(20),this.curves("rgb",[5,0],[130,150],[190,220],[250,255]),this.sharpen(15),this.vignette("45%",20),t&&(this.greyscale(),this.contrast(4)),this}),a.Filter.register("sinCity",function(){return this.contrast(100),this.brightness(15),this.exposure(10),this.posterize(80),this.clip(30),this.greyscale()}),a.Filter.register("sunrise",function(){return this.exposure(3.5),this.saturation(-5),this.vibrance(50),this.sepia(60),this.colorize("#e87b22",10),this.channels({red:8,blue:8}),this.contrast(5),this.gamma(1.2),this.vignette("55%",25)}),a.Filter.register("crossProcess",function(){return this.exposure(5),this.colorize("#e87b22",4),this.sepia(20),this.channels({blue:8,red:3}),this.curves("b",[0,0],[100,150],[180,180],[255,255]),this.contrast(15),this.vibrance(75),this.gamma(1.6)}),a.Filter.register("orangePeel",function(){return this.curves("rgb",[0,0],[100,50],[140,200],[255,255]),this.vibrance(-30),this.saturation(-30),this.colorize("#ff9000",30),this.contrast(-5),this.gamma(1.4)}),a.Filter.register("love",function(){return this.brightness(5),this.exposure(8),this.contrast(4),this.colorize("#c42007",30),this.vibrance(50),this.gamma(1.3)}),a.Filter.register("grungy",function(){return this.gamma(1.5),this.clip(25),this.saturation(-60),this.contrast(5),this.noise(5),this.vignette("50%",30)}),a.Filter.register("jarques",function(){return this.saturation(-35),this.curves("b",[20,0],[90,120],[186,144],[255,230]),this.curves("r",[0,0],[144,90],[138,120],[255,255]),this.curves("g",[10,0],[115,105],[148,100],[255,248]),this.curves("rgb",[0,0],[120,100],[128,140],[255,255]),this.sharpen(20)}),a.Filter.register("pinhole",function(){return this.greyscale(),this.sepia(10),this.exposure(10),this.contrast(15),this.vignette("60%",35)}),a.Filter.register("oldBoot",function(){return this.saturation(-20),this.vibrance(-50),this.gamma(1.1),this.sepia(30),this.channels({red:-10,blue:5}),this.curves("rgb",[0,0],[80,50],[128,230],[255,255]),this.vignette("60%",30)}),a.Filter.register("glowingSun",function(t){if(null==t&&(t=!0),this.brightness(10),this.newLayer(function(){return this.setBlendingMode("multiply"),this.opacity(80),this.copyParent(),this.filter.gamma(.8),this.filter.contrast(50),this.filter.exposure(10)}),this.newLayer(function(){return this.setBlendingMode("softLight"),this.opacity(80),this.fillColor("#f49600")}),this.exposure(20),this.gamma(.8),t)return this.vignette("45%",20)}),a.Filter.register("hazyDays",function(){return this.gamma(1.2),this.newLayer(function(){return this.setBlendingMode("overlay"),this.opacity(60),this.copyParent(),this.filter.channels({red:5}),this.filter.stackBlur(15)}),this.newLayer(function(){return this.setBlendingMode("addition"),this.opacity(40),this.fillColor("#6899ba")}),this.newLayer(function(){return this.setBlendingMode("multiply"),this.opacity(35),this.copyParent(),this.filter.brightness(40),this.filter.vibrance(40),this.filter.exposure(30),this.filter.contrast(15),this.filter.curves("r",[0,40],[128,128],[128,128],[255,215]),this.filter.curves("g",[0,40],[128,128],[128,128],[255,215]),this.filter.curves("b",[0,40],[128,128],[128,128],[255,215]),this.filter.stackBlur(5)}),this.curves("r",[20,0],[128,158],[128,128],[235,255]),this.curves("g",[20,0],[128,128],[128,128],[235,255]),this.curves("b",[20,0],[128,108],[128,128],[235,255]),this.vignette("45%",20)}),a.Filter.register("herMajesty",function(){return this.brightness(40),this.colorize("#ea1c5d",10),this.curves("b",[0,10],[128,180],[190,190],[255,255]),this.newLayer(function(){return this.setBlendingMode("overlay"),this.opacity(50),this.copyParent(),this.filter.gamma(.7),this.newLayer(function(){return this.setBlendingMode("normal"),this.opacity(60),this.fillColor("#ea1c5d")})}),this.newLayer(function(){return this.setBlendingMode("multiply"),this.opacity(60),this.copyParent(),this.filter.saturation(50),this.filter.hue(90),this.filter.contrast(10)}),this.gamma(1.4),this.vibrance(-30),this.newLayer(function(){return this.opacity(10),this.fillColor("#e5f0ff")}),this}),a.Filter.register("nostalgia",function(){return this.saturation(20),this.gamma(1.4),this.greyscale(),this.contrast(5),this.sepia(100),this.channels({red:8,blue:2,green:4}),this.gamma(.8),this.contrast(5),this.exposure(10),this.newLayer(function(){return this.setBlendingMode("overlay"),this.copyParent(),this.opacity(55),this.filter.stackBlur(10)}),this.vignette("50%",30)}),a.Filter.register("hemingway",function(){return this.greyscale(),this.contrast(10),this.gamma(.9),this.newLayer(function(){return this.setBlendingMode("multiply"),this.opacity(40),this.copyParent(),this.filter.exposure(15),this.filter.contrast(15),this.filter.channels({green:10,red:5})}),this.sepia(30),this.curves("rgb",[0,10],[120,90],[180,200],[235,255]),this.channels({red:5,green:-2}),this.exposure(15)}),a.Filter.register("concentrate",function(){return this.sharpen(40),this.saturation(-50),this.channels({red:3}),this.newLayer(function(){return this.setBlendingMode("multiply"),this.opacity(80),this.copyParent(),this.filter.sharpen(5),this.filter.contrast(50),this.filter.exposure(10),this.filter.channels({blue:5})}),this.brightness(10)}),function(){var t,e,i;e=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],i=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24],t=function(){return this.r=0,this.g=0,this.b=0,this.a=0,this.next=null},a.Plugin.register("stackBlur",function(r){var n,s,o,a,h,c,u,l,d,g,p,f,m,b,v,y,x,w,D,R,M,L,P,S,I,B,C,k,F,T,A,z,O,N,U,E,j,J,H,G,W,_,K,q;if(!(isNaN(r)||r<1)){for(r|=0,v=this.pixelData,F=this.dimensions.width,l=this.dimensions.height,a=r+r+1,F<<2,T=F-1,d=l-1,R=r+1,k=R*(R+1)/2,C=new t,P=C,g=E=1;1<=a?E<a:E>a;g=1<=a?++E:--E)P=P.next=new t,g===R&&(S=P);for(P.next=C,I=null,B=null,U=O=0,p=e[r],L=i[r],z=j=0;0<=l?j<l:j>l;z=0<=l?++j:--j){for(x=h=n=D=u=o=0,w=R*(y=v[O]),c=R*(b=v[O+1]),s=R*(m=v[O+2]),D+=k*y,u+=k*b,o+=k*m,P=C,g=J=0;0<=R?J<R:J>R;g=0<=R?++J:--J)P.r=y,P.g=b,P.b=m,P=P.next;for(g=H=1;1<=R?H<R:H>R;g=1<=R?++H:--H)f=O+((T<g?T:g)<<2),D+=(P.r=y=v[f])*(M=R-g),u+=(P.g=b=v[f+1])*M,o+=(P.b=m=v[f+2])*M,x+=y,h+=b,n+=m,P=P.next;for(I=C,B=S,A=G=0;0<=F?G<F:G>F;A=0<=F?++G:--G)v[O]=D*p>>L,v[O+1]=u*p>>L,v[O+2]=o*p>>L,D-=w,u-=c,o-=s,w-=I.r,c-=I.g,s-=I.b,f=U+((f=A+r+1)<T?f:T)<<2,x+=I.r=v[f],h+=I.g=v[f+1],n+=I.b=v[f+2],D+=x,u+=h,o+=n,I=I.next,w+=y=B.r,c+=b=B.g,s+=m=B.b,x-=y,h-=b,n-=m,B=B.next,O+=4;U+=F}for(A=W=0;0<=F?W<F:W>F;A=0<=F?++W:--W){for(h=n=x=u=o=D=0,O=A<<2,w=R*(y=v[O]),c=R*(b=v[O+1]),s=R*(m=v[O+2]),D+=k*y,u+=k*b,o+=k*m,P=C,g=_=0;0<=R?_<R:_>R;g=0<=R?++_:--_)P.r=y,P.g=b,P.b=m,P=P.next;for(N=F,g=K=1;1<=r?K<=r:K>=r;g=1<=r?++K:--K)O=N+A<<2,D+=(P.r=y=v[O])*(M=R-g),u+=(P.g=b=v[O+1])*M,o+=(P.b=m=v[O+2])*M,x+=y,h+=b,n+=m,P=P.next,g<d&&(N+=F);for(O=A,I=C,B=S,z=q=0;0<=l?q<l:q>l;z=0<=l?++q:--q)f=O<<2,v[f]=D*p>>L,v[f+1]=u*p>>L,v[f+2]=o*p>>L,D-=w,u-=c,o-=s,w-=I.r,c-=I.g,s-=I.b,f=A+((f=z+R)<d?f:d)*F<<2,D+=x+=I.r=v[f],u+=h+=I.g=v[f+1],o+=n+=I.b=v[f+2],I=I.next,w+=y=B.r,c+=b=B.g,s+=m=B.b,x-=y,h-=b,n-=m,B=B.next,O+=F}return this}}),a.Filter.register("stackBlur",function(t){return this.processPlugin("stackBlur",[t])})}(),a.Filter.register("threshold",function(t){return this.process("threshold",function(e){var i;return i=.2126*e.r+.7152*e.g+.0722*e.b,i<t?(e.r=0,e.g=0,e.b=0):(e.r=255,e.g=255,e.b=255),e})})}).call(void 0)},function(t,e){e.endianness=function(){return"LE"},e.hostname=function(){return"undefined"!=typeof location?location.hostname:""},e.loadavg=function(){return[]},e.uptime=function(){return 0},e.freemem=function(){return Number.MAX_VALUE},e.totalmem=function(){return Number.MAX_VALUE},e.cpus=function(){return[]},e.type=function(){return"Browser"},e.release=function(){return"undefined"!=typeof navigator?navigator.appVersion:""},e.networkInterfaces=e.getNetworkInterfaces=function(){return{}},e.arch=function(){return"javascript"},e.platform=function(){return"browser"},e.tmpdir=e.tmpDir=function(){return"/tmp"},e.EOL="\n",e.homedir=function(){return"/"}}]);